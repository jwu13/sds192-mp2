---
title: "Mini-Project 2"
author: "Your Name Here"
date: "2019-03-24"
output: 
  html_document:
    code_folding: hide
---
## Loading the data
```{r, message = FALSE, warnings = FALSE}
library(tidyverse)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r message = FALSE, warnings = FALSE}
candidates_2 <- candidates %>%
  select(cand_id, cand_party_affiliation, cand_office) %>%
  filter(cand_party_affiliation %in% c("DEM", "REP")) %>%
  filter(cand_office == "H") %>%
  mutate(party = ifelse(cand_party_affiliation == "DEM", "D", "R")) %>%
  select(-cand_party_affiliation, -cand_office) 
```
### cand_office
H = House
P = President
S = Senate
```{r message = FALSE, warnings = FALSE}
committee_2 <- committees %>%
  select(cmte_id, cmte_state, cmte_type, org_type)
```
### cmte_type
### org_type
C = Corporation
L = Labor organization
M = Membership organization
T = Trade association
V = Cooperative
W = Corporation without capital stock
```{r message = FALSE, warnings = FALSE}
contributions_2 <- contributions %>%
  select(cmte_id, entity_type, transaction_amt, transaction_type, cand_id) %>%
  filter(transaction_type == "24E" & transaction_amt > 0)
```
### entity_type
CAN = Candidate
CCM = Candidate Committee
COM = Committee
IND = Individual (a person)
ORG = Organization (not a committee and not a person)
PAC = Political Action Committee
PTY = Party Organization
### transaction_type
24A - to oppose
24E - to support
### other_id
FEC ID of the recipient committee or the supported or opposed candidate ID.
### cand_id
Candidate receiving money from the filing committee
### cmte_dsgn
A = Authorized by a candidate
B = Lobbyist/Registrant PAC
D = Leadership PAC
J = Joint fundraiser
P = Principal campaign committee of a candidate
U = Unauthorized
### cmte_type
C=Communication Cost	
D=Delegate Committee	
E=Electioneering Communication	
H=House	Campaign committees for candidates for the House of Representatives
I=Independent Expenditor (Person or Group)	
N=PAC - Nonqualified	

O=Independent Expenditure-Only (Super PACs)	

P=Presidential
Q=PAC - Qualified
S=Senate
U=Single Candidate Independent Expenditure	
V=PAC with Non-Contribution Account - Nonqualified
W=PAC with Non-Contribution Account - Qualified
X=Party - Nonqualified
Y=Party - Qualified
Z=National Party Nonfederal Account

```{r message = FALSE, warnings = FALSE}
house_2 <- house_elections %>%
  filter(party %in% c("D", "R")) %>%
  select(fec_id, party, general_votes, primary_votes, ge_winner, -party) %>%
  filter(general_votes != 0)
```

```{r}
join_1 <- candidates_2 %>%
  full_join(house_2, by = c("cand_id" = "fec_id"))
```

```{r}
join_2 <- join_1 %>%
  full_join(contributions_2, by = c("cand_id" = "cand_id")) %>%
  select(-transaction_type) %>%
  filter(!is.na(party))
```

```{r}
m1 <- lm(general_votes ~ transaction_amt, data = join_2)
summary(m1)
```
r-square is 0.002467

```{r}
ggplot(join_2, aes(x = transaction_amt, y = primary_votes, color = party)) +
  geom_point(alpha = 0.1) +
  xlim(0, 50000) +
  scale_color_manual(values = c("blue", "red")) +
  geom_smooth() +
  facet_wrap(~party)

ggplot(join_2, aes(x = transaction_amt, y = general_votes, color = party)) +
  geom_point(alpha = 0.1) +
  xlim(0, 50000) +
  scale_color_manual(values = c("blue", "red")) +
  geom_smooth() +
  facet_wrap(~party)
```

```{r}

```


